(()=>{let t=new Image,e="",a=document.getElementById("button_container"),n=document.createElement("button"),s=document.createElement("button"),i=document.createElement("button"),d=document.getElementById("filtered_canvas").getContext("2d"),c=document.createElement("video");async function l(){if(d.drawImage(c,0,0,1280,720),"ar_sticker"===e)d.drawImage(t,150,200,250,400);else if("grayscale"===e){let t,e,a=d.getImageData(0,0,1280,720);for(e=0;e<a.data.length;e+=4)t=(a.data[e]+a.data[e+1]+a.data[e+2])/3,a.data[e]=t,a.data[e+1]=t,a.data[e+2]=t;d.putImageData(a,0,0)}requestAnimationFrame(l)}n.classList.add("btn"),n.classList.add("btn-success"),n.classList.add("custom_btn_length"),n.innerText="Grayscale",n.addEventListener("click",(function(){e="grayscale",console.log("switch to grayscale")})),s.classList.add("btn"),s.classList.add("btn-info"),s.classList.add("custom_btn_length"),s.innerText="AR Sticker",s.addEventListener("click",(function(){e="ar_sticker",console.log("switch to ar sticker")})),i.classList.add("btn"),i.classList.add("btn-primary"),i.classList.add("custom_btn_length"),i.innerText="Remove Filters",i.addEventListener("click",(function(){e="original",console.log("remove all filters")})),a.appendChild(n),a.appendChild(s),a.appendChild(i),Promise.all([t.src="img/duck2.png"]).then((function(){t.crossOrigin="Anonymous",navigator.mediaDevices.getUserMedia({audio:!1,video:{mandatory:{minWidth:1280,maxWidth:1280,minHeight:720,maxHeight:720}}}).then((t=>{c.srcObject=t,c.muted=!0,c.play(),l()}))}))})();